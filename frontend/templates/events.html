<!DOCTYPE html>
<html>
<head>
  <title>Events</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body style="background-color:#f8fafc;">

<!-- Navbar -->
<nav class="navbar navbar-dark" style="background-color:#4f46e5;">
  <div class="container">
    <a class="navbar-brand fw-bold" href="/">Event Scheduler</a>
  </div>
</nav>

<!-- Page Content -->
<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-md-6">

      <div class="card shadow-sm">
        <div class="card-body">

          <h4 class="text-center mb-4">Create Event</h4>

          <label class="form-label">Event Title</label>
          <input id="title" class="form-control mb-3">

          <label class="form-label">Start Time</label>
          <input id="start" type="datetime-local" class="form-control mb-3">

          <label class="form-label">End Time</label>
          <input id="end" type="datetime-local" class="form-control mb-3">

          <label class="form-label">Description</label>
          <textarea id="desc" class="form-control mb-3"></textarea>

          <button
            id="createBtn"
            type="button"
            class="btn w-100 text-white"
            style="background-color:#4f46e5;">
            Create Event
          </button>

          <p id="msg" class="mt-3 text-center fw-semibold"></p>

        </div>
      </div>

    </div>
  </div>
</div>

<script>
document.getElementById("createBtn").addEventListener("click", handleCreateEvent);

function handleCreateEvent() {
  fetch('/events/', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      title: document.getElementById("title").value,
      start_time: document.getElementById("start").value,
      end_time: document.getElementById("end").value,
      description: document.getElementById("desc").value
    })
  })
  .then(async response => {
    const data = await response.json();
    if (!response.ok) {
      throw new Error(data.error || "Failed to create event");
    }
    return data;
  })
  .then(() => {
    msg.innerText = "âœ… Event created successfully!";
    msg.style.color = "#16a34a";

    // reset form
    title.value = "";
    start.value = "";
    end.value = "";
    desc.value = "";
  })
  .catch(err => {
    msg.innerText = err.message;
    msg.style.color = "#dc2626";
  });
}
</script>

</body>
</html>